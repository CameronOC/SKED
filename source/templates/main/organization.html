{% extends "_base.html" %}

{% block content %}

<h1>{{ organization.name }}</h1>
<h2>Owner: {{ organization.owner.first_name }} {{ organization.owner.last_name }}</h2>

{% if organization.owner.id == g.user.id %}
    <h2>Employees</h2>
    <ul>
        {% for membership in organization.memberships.all() %}
        <li>
            {{ membership.member.first_name }} {{ membership.member.last_name }}
            {% if not membership.joined %}
            (invited)
            {% endif %}
            {% if membership.joined %}
            <a href="/organization/{{ organization.id }}/manager_member_profile/{{ membership.member.id }}"> edit </a>
            {% endif %}
        </li>
        {% endfor %}
    </ul>


<br>
<a href="/organization/{{ organization.id }}/invite">Invite people to this organization</a>
<br>
{% else %}
{% endif %}

<br>

{% if organization.owned_positions %}
<ul class="list-group">
    
    {% for pos in organization.owned_positions.all() %}

    <li class="list-group-item"><a href="/organization/{{ organization.id }}/position/{{pos.id}}">{{ pos.title }}</a>
    <p> 
    
        {% for person in pos.assigned_users%}  
        
            {{ person.first_name }} {{ person.last_name}}  {%if organization.owner.id == g.user.id%}<a href="/organization/{{ organization.id }}/manager_member_profile/{{ person.id }}"> edit </a>{%endif%} </p>
    
        {% endfor %}
        {% if not pos.assigned_users %}
            <p>unassigned</p>
        {% endif %}

    </li>

    {% endfor %}
    
    <br>
    {% if organization.owner.id == g.user.id %}
    <a class="btn btn-success" href="/organization/{{ organization.id }}/create_position" type="submit"> <i class="fa fa-plus" aria-hidden="true"></i> Create New Position</a>
    {%endif%}

</ul>

{% else %}
Looks like you don't have any positions, would you like to <a href="/organization/{{ organization.id }}/create_position">create one</a>?
{% endif %}

<a href="/home">Go back</a>

{% endblock %}